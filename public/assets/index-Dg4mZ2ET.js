import{b as x,d as _,T as y,a as C}from"./index-Bu_rpr0j.js";import{c as v,w,a5 as I,a4 as R,x as T}from"./index-KPShGsqr.js";import A from"./popupForm-Dh7KWD7X.js";import{e as K,p as b,v as D,as as G,at as O,x as q,m as B,o as i,h as E,s,O as h,W as g,l as u}from"./vue-BZJL1-P9.js";import"./index-DkzA5vqp.js";import"./index-B3Hzgth0.js";import"./validate-45bXqi5h.js";function F(){return v({url:"/admin/auth.Rule/index",method:"get"})}const L={class:"default-main ba-table-box"},Q=K({name:"auth/group",__name:"index",setup(N){const d=b(),m=b(),{t:a}=D.useI18n(),k=w(),e=new x(new I("/admin/auth.Group/"),{expandAll:!0,dblClickNotEditColumn:[void 0],column:[{type:"selection",align:"center"},{label:a("auth.group.Group name"),prop:"name",align:"left",width:"200"},{label:a("auth.group.jurisdiction"),prop:"rules",align:"center"},{label:a("State"),prop:"status",align:"center",render:"tag",custom:{0:"danger",1:"success"},replaceValue:{0:a("Disable"),1:a("Enable")}},{label:a("Update time"),prop:"update_time",align:"center",width:"160",render:"datetime"},{label:a("Create time"),prop:"create_time",align:"center",width:"160",render:"datetime"},{label:a("Operate"),align:"center",width:"130",render:"buttons",buttons:_(["edit","delete"])}]},{defaultItems:{status:"1"}},{onSubmit:({formEl:t,operate:r,items:l})=>{var l=G(l);l.rules=d.value.getCheckeds();for(const n in l)l[n]===null&&delete l[n];r=r.replace(r[0],r[0].toLowerCase());let f=()=>{e.form.submitLoading=!0,e.api.postData(r,l).then(n=>{var p;e.onTableHeaderAction("refresh",{}),e.form.submitLoading=!1,(p=e.form.operateIds)==null||p.shift(),e.form.operateIds.length>0?e.toggleForm("Edit",e.form.operateIds):e.toggleForm(),e.runAfter("onSubmit",{res:n})}).catch(()=>{e.form.submitLoading=!1})};return t?(e.form.ref=t,t.validate(n=>{n&&f()})):f(),!1},onTableDblclick:({row:t})=>e.table.extend.adminGroup.indexOf(t.id)===-1},{getIndex:({res:t})=>{e.table.extend.adminGroup=t.data.group;let r=R(e.table.column,"render","buttons");e.table.column[r].buttons.forEach(o=>{o.display=l=>t.data.group.indexOf(l.id)===-1})},toggleForm({operate:t}){t=="Add"&&c()},requestEdit(){c()}}),c=()=>{F().then(t=>{if(e.form.extend.menuRules=t.data.list,e.form.items.rules&&e.form.items.rules.length)if(e.form.items.rules.includes("*")){let r=[];for(const o in e.form.extend.menuRules)r.push(e.form.extend.menuRules[o].id);e.form.extend.defaultCheckedKeys=r}else e.form.extend.defaultCheckedKeys=e.form.items.rules;else e.form.extend.defaultCheckedKeys=[];e.form.extend.treeKey=T()})};return O("baTable",e),q(()=>{e.table.ref=m.value,e.mount(),e.getIndex()}),(t,r)=>{const o=B("el-alert");return i(),E("div",L,[s(k).super?g("",!0):(i(),h(o,{key:0,class:"ba-table-alert",title:s(a)("auth.group.Manage subordinate role groups here"),type:"info","show-icon":""},null,8,["title"])),s(e).table.remark?(i(),h(o,{key:1,class:"ba-table-alert",title:s(e).table.remark,type:"info","show-icon":""},null,8,["title"])):g("",!0),u(y,{buttons:["refresh","add","edit","delete","unfold","quickSearch","columnDisplay"],"quick-search-placeholder":s(a)("Quick search placeholder",{fields:s(a)("auth.group.GroupName")})},null,8,["quick-search-placeholder"]),u(C,{ref_key:"tableRef",ref:m,pagination:!1},null,512),u(A,{ref_key:"formRef",ref:d},null,512)])}}});export{Q as default};
