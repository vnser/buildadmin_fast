import{D as J,_ as W}from"./darkSwitch-BalzYbFH.js";import{i as Y,e as F,m as _,Y as j,o as a,h as R,Z as q,_ as E,s as n,$ as M,P as i,Q as o,X as I,W as b,V as p,l as h,a0 as A,O as P,a1 as Q,r as K,C as X,k as y,n as ee,a2 as ne,a3 as te}from"./vue-DFhsJZqQ.js";import{d as ae,r as oe,b as Z,u as V,a as T,c as se,s as re,_ as B,e as le,f as ie,g as ue,l as ce,h as de}from"./index-CPy2hEef.js";import{h as me,o as H}from"./router-CVmtgzg_.js";import{t as fe}from"./useDark-BEhBc5Tk.js";const pe="/api/index/";function he(v,g){ae(()=>{if(oe.currentRoute.value.meta.initialize===!1)return;const m=Z(),u=V();if(!m.isLogin()&&u.initialize||m.isLogin()&&u.userInitialize)return;const s=T();se({url:pe+"index",method:"get",params:{requiredLogin:g?1:0}}).then(l=>{me(l.data.rules,l.data.menus),u.dataFill(l.data.site),s.setStatus(l.data.openMemberCenter),Y(l.data.userInfo)||(l.data.userInfo.refresh_token=m.getToken("refresh"),m.dataFill(l.data.userInfo),u.setUserInitialize(!0)),l.data.openMemberCenter||s.setLayoutMode("Disable"),u.setInitialize(!0),re(),typeof v=="function"&&v(l)})},200)()}const _e=F({__name:"menuSub",props:{menus:{default:()=>[]},showIcon:{type:Boolean,default:!1}},setup(v){const g=v,m=u=>{var s;u.path=="/"||((s=u.meta)==null?void 0:s.type)=="menu_dir"||H(u)};return(u,s)=>{const l=_("Icon"),r=_("el-sub-menu"),N=_("el-menu-item"),k=j("blur");return a(!0),R(E,null,q(g.menus,(f,S)=>{var z,$;return a(),R(E,{key:S},[n(Y)(f.children)?M((a(),i(N,{key:1,onClick:c=>n(H)(f),index:"column-"+(($=f.meta)==null?void 0:$.id),class:A(f.name.replace(/[\/]/g,"-"))},{title:o(()=>{var c;return[b(p((c=f.meta)==null?void 0:c.title),1)]}),default:o(()=>{var c;return[u.showIcon?(a(),i(l,{key:0,name:(c=f.meta)==null?void 0:c.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):I("",!0)]}),_:2},1032,["onClick","index","class"])),[[k]]):M((a(),i(r,{key:0,onClick:c=>m(f),index:`column-${(z=f.meta)==null?void 0:z.id}`},{title:o(()=>{var c,e;return[u.showIcon?(a(),i(l,{key:0,name:(c=f.meta)==null?void 0:c.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):I("",!0),b(" "+p((e=f.meta)==null?void 0:e.title),1)]}),default:o(()=>[h(D,{menus:f.children,"show-icon":u.showIcon},null,8,["menus","show-icon"])]),_:2},1032,["onClick","index"])),[[k]])],64)}),128)}}}),D=B(_e,[["__scopeId","data-v-0badd86c"]]),ve={class:"header-user-box"},ge=["src"],ke=F({__name:"menu",props:{showIcon:{type:Boolean,default:!1}},setup(v){const g=P(),m=Q(),u=le(),s=Z(),l=V(),r=T(),N=v,k=K({activeMenu:""}),f=e=>{var t,w;for(const d in r.state.navUserMenus)if(r.state.navUserMenus[d].path==e.path||r.state.navUserMenus[d].name==e.name)return(t=r.state.navUserMenus[d].meta)==null?void 0:t.id;for(const d in l.headNav)if(l.headNav[d].path==e.path||l.headNav[d].name==e.name)return(w=l.headNav[d].meta)==null?void 0:w.id},S=e=>{if(e.path=="/")return k.activeMenu="index";const t=f(e);t?k.activeMenu="column-"+t:e.path.startsWith("/user")&&(k.activeMenu="user")};S(g);const z=e=>{if($(l.headNav,e)||$(r.state.navUserMenus,e)){const t=k.activeMenu;k.activeMenu="",ee(()=>{k.activeMenu=t})}},$=(e,t)=>t.indexOf("language-switch")===0||t=="theme-switch"?!0:c(e,t),c=(e,t)=>{var w,d,L;for(const U in e){if(`column-${(w=e[U].meta)==null?void 0:w.id}`==t)return((d=e[U].meta)==null?void 0:d.menu_type)=="link";if((L=e[U].children)!=null&&L.length)return c(e[U].children,t)}return!1};return X(()=>g.path,()=>{S(g)}),(e,t)=>{const w=_("Icon"),d=_("el-menu-item"),L=_("el-sub-menu"),U=_("el-menu"),x=j("blur");return a(),i(U,{ref_key:"layoutMenuRef",ref:ce,"default-active":k.activeMenu,onSelect:z},{default:o(()=>[M((a(),i(d,{onClick:t[0]||(t[0]=C=>n(m).push({name:"/"})),index:"index"},{title:o(()=>[b(p(e.$t("Home")),1)]),default:o(()=>[N.showIcon?(a(),i(w,{key:0,name:"fa fa-home",color:"var(--el-text-color-primary)"})):I("",!0)]),_:1})),[[x]]),h(D,{menus:n(l).headNav,"show-icon":e.showIcon},null,8,["menus","show-icon"]),n(r).state.open?(a(),R(E,{key:0},[n(s).isLogin()?M((a(),i(L,{key:0,onClick:t[3]||(t[3]=C=>e.$attrs.mode=="vertical"?"":n(m).push({name:"user"})),index:"user-box"},{title:o(()=>[y("div",ve,[y("img",{class:A(["header-user-avatar",e.$attrs.mode=="vertical"?"icon-header-user-avatar":""]),src:n(ie)(n(s).avatar?n(s).avatar:"/static/images/avatar.png"),alt:""},null,10,ge),b(" "+p(n(s).nickname),1)])]),default:o(()=>[M((a(),i(d,{onClick:t[1]||(t[1]=C=>n(m).push({name:"user"})),index:"user"},{default:o(()=>[e.showIcon?(a(),i(w,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+p(e.$t("Member Center")),1)]),_:1})),[[x]]),h(D,{menus:n(r).state.navUserMenus,"show-icon":e.showIcon},null,8,["menus","show-icon"]),h(D,{menus:n(r).state.viewRoutes,"show-icon":e.showIcon},null,8,["menus","show-icon"]),M((a(),i(d,{onClick:t[2]||(t[2]=C=>n(s).logout()),index:"user-logout"},{default:o(()=>[e.showIcon?(a(),i(w,{key:0,name:"fa fa-sign-out",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+p(e.$t("Logout login")),1)]),_:1})),[[x]])]),_:1})),[[x]]):M((a(),i(d,{key:1,onClick:t[4]||(t[4]=C=>n(m).push({name:"user"})),index:"user"},{default:o(()=>[e.showIcon?(a(),i(w,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+p(e.$t("Member Center")),1)]),_:1})),[[x]]),M((a(),i(L,{index:"language-switch",class:"language-switch"},{title:o(()=>[e.showIcon?(a(),i(w,{key:0,name:"local-lang",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+p(e.$t("Language")),1)]),default:o(()=>[(a(!0),R(E,null,q(n(u).lang.langArray,C=>(a(),i(d,{onClick:Ne=>n(ue)(C.name),key:C.name,index:"language-switch-"+C.value,class:"language-switch"},{default:o(()=>[e.showIcon?(a(),i(w,{key:0,name:"fa fa-circle-o",color:"var(--el-text-color-primary)"})):I("",!0),b(" "+p(C.value),1)]),_:2},1032,["onClick","index"]))),128))]),_:1})),[[x]]),h(d,{index:"theme-switch",class:A(["theme-switch",e.$attrs.mode+"-theme-switch"])},{default:o(()=>[h(J,{onClick:t[5]||(t[5]=C=>n(fe)())})]),_:1},8,["class"])],64)):I("",!0)]),_:1},8,["default-active"])}}}),O=B(ke,[["__scopeId","data-v-2b1cb78f"]]),G=v=>(ne("data-v-006f95d8"),v=v(),te(),v),we=G(()=>y("img",{src:W},null,-1)),ye={class:"site-name"},Ce={class:"header-row"},Ie=G(()=>y("img",{src:W},null,-1)),be={class:"site-name"},Me=F({__name:"header",setup(v){const g=P(),m=Q(),u=V(),s=T();return X(()=>g.path,()=>{s.toggleMenuExpand(!1)},{immediate:!0}),he(),(l,r)=>{const N=_("Icon"),k=_("el-scrollbar"),f=_("el-col"),S=_("el-row"),z=_("el-drawer"),$=_("el-header");return a(),i($,{class:"header"},{default:o(()=>[h(S,{justify:"center"},{default:o(()=>[h(f,{class:"header-row",xs:24,sm:24,md:16},{default:o(()=>[y("div",{onClick:r[0]||(r[0]=c=>n(m).push({name:"/"})),class:"header-logo"},[we,y("span",ye,p(n(u).siteName),1)]),n(s).state.menuExpand?I("",!0):(a(),R("div",{key:0,onClick:r[1]||(r[1]=c=>n(s).toggleMenuExpand(!0)),class:"user-menus-expand hidden-md-and-up"},[h(N,{name:"fa fa-indent",color:"var(--el-color-primary)",size:"20"})])),h(k,{ref_key:"layoutMenuScrollbarRef",ref:de,class:"hidden-sm-and-down"},{default:o(()=>[h(O,{class:"frontend-header-menu",ellipsis:!1,mode:"horizontal"})]),_:1},512)]),_:1})]),_:1}),h(z,{class:"ba-aside-drawer","append-to-body":!0,modelValue:n(s).state.menuExpand,"onUpdate:modelValue":r[4]||(r[4]=c=>n(s).state.menuExpand=c),"with-header":!1,direction:"ltr",size:"40%"},{default:o(()=>[y("div",Ce,[y("div",{onClick:r[2]||(r[2]=c=>n(m).push({name:"/"})),class:"header-logo"},[Ie,y("span",be,p(n(u).siteName),1)]),y("div",{onClick:r[3]||(r[3]=c=>n(s).toggleMenuExpand(!1)),class:"user-menus-expand hidden-md-and-up"},[h(N,{name:"fa fa-dedent",color:"var(--el-color-primary)",size:"20"})])]),h(O,{"show-icon":!0,mode:"vertical"})]),_:1},8,["modelValue"])]),_:1})}}}),De=B(Me,[["__scopeId","data-v-006f95d8"]]),$e={href:"http://beian.miit.gov.cn/"},xe=F({__name:"footer",setup(v){const g=V();return(m,u)=>{const s=_("el-footer");return a(),i(s,{class:"footer"},{default:o(()=>[y("div",null,[b(" Copyright @ 2020~"+p(new Date().getFullYear())+" "+p(n(g).siteName)+" "+p(m.$t("Copyright"))+" ",1),y("a",$e,p(n(g).recordNumber),1)])]),_:1})}}}),Ee=B(xe,[["__scopeId","data-v-ff7303bf"]]);export{Ee as F,De as H,he as i};
